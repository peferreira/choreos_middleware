Requirements
============

- Maven 3
- OpenVPN 2 (when using OpenStack)

About how to compile, see the INSTALL file.

Eclipse IDE
===========

$ mvn -Declipse.workspace=/path/to/your/workspace eclipse:configure-workspace
$ mvn -Declipse.workspace=/path/to/your/workspace eclipse:eclipse

The first one only needs to be run once per workspace. Then import existent project in Eclipse IDE. If you find many compiler erros change the compiler version to 1.6 (also search for facets in project -> properties)

OpenVPN (for OpenStack)
===========

Install OpenVPN 2.

Create a folder and unpack the access files received from the OpenVPN administrator. 
The files should be:
ca.crt, <username>.crt, <username>.csr, <username>.key, openvpn.conf

Note: For MACOSX, TUN/TAP devices are needed. Install it from http://tuntaposx.sourceforge.net/.

Execute this on commandline while on the folder that was just created:
sudo openvpn2 --config openvpn.conf

OpenVPN will connect to the server. Wait until the connection successful message appears before trying to use OpenStack.

Configuring a Local VM for Faster and Cheaper Tests
===================================================

There are some useful links in the end. Below there are instructions on how to configure a VM, bootstrap it and revert it to a previous state (including chef run list). You must have a chef knife configured first (chef-repo/README).

VM Creation
-----------
Be sure you can:
- SSH to it without typing a password.
- Use sudo without typing a password (type `$sudo visudo` and add the line "<user> ALL = NOPASSWD: ALL" at the end (change <user> by the actual user).
Also synchronize the machine time (#ntpdate ccsl.ime.usp.br).

Configure the FIXED_VM settings in the file src/main/resources/nodepoolmanager.properties (you will find a template there).


Chef Bootstrap
--------------
The easiest way to bootstrap your local VM is to run the java junit bootstrap test. It can take a few minutes and it will save you a lot of time if you take a snapshot after bootstraping.

Restoring a Snapshot
--------------------
After testing and installing some recipes in the VM, you can restore the bootstrapped snapshot (as well as any other you have) by manually doing it in your preferred virtualization software (e.g. VirtualBox) and resetting the chef node run list. The last step can be easily done using the script chef-repo/run_list_reset.sh (create chef-repo/run_list_reset.conf according to the template (.template suffix).

Links
-----
- Configuring VirtualBox Network: http://ccsl.ime.usp.br/foswiki/bin/view/Choreos/VMs
- Passwordless SSH: http://www.integrade.org.br/ssh-without-password
Obs: don't use a key with password.
